<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Descubre Ventanilla, 33 viviendas exclusivas en Granada desde €184,612. Diseñadas por arquitectos de prestigio, perfectas para tu nuevo hogar.">
    <meta name="keywords" content="comprar vivienda Granada, promoción inmobiliaria Granada, Ventanilla Granada, Barsant Promociones Inmobiliarias, viviendas nuevas Granada">
    <meta name="author" content="Barsant Promociones Inmobiliarias">
    <!-- Open Graph para redes sociales -->
    <meta property="og:title" content="Ventanilla | Barsant Promociones Inmobiliarias">
    <meta property="og:description" content="Descubre Ventanilla, 33 viviendas exclusivas en Granada desde €184,612. Diseñadas por arquitectos de prestigio, perfectas para tu nuevo hogar.">
    <meta property="og:image" content="https://www.barsantventanilla.com/images/hero.jpg">
    <meta property="og:url" content="https://www.barsantventanilla.com">
    <meta property="og:type" content="website">
    <title>Ventanilla | Barsant Promociones Inmobiliarias</title>
    <!-- Fuentes -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <!-- Iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Estilos Modularizados -->
    <link rel="stylesheet" href="/src/css/styles.css">
    <link rel="stylesheet" href="/src/css/pages/gallery.css">
    <!-- Script de autenticación -->
    <!-- <script type="module" src="/src/js/auth.js"></script> -->
    <!--<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.js"></script> -->
</head>
<body>

    <!-- Header -->
    <div id="header-placeholder"></div>

    <!-- Inicio Section -->
    <div id="inicio-placeholder"></div>
     
    <!-- About Section -->
    <div id="about-placeholder"></div>

    <!-- Features -->
    <div id="features-placeholder"></div>

    <!-- Properties -->
    <div id="properties-placeholder"></div>

    <!-- Map Section -->
    <div id="map-placeholder"></div>
    
    <!-- Gallery -->
    <div id="gallery-placeholder"></div>

    <!-- Documentation -->
    <div id="documentation-placeholder"></div>

    <!-- Contact -->
    <!--<div id="contact-placeholder"></div> -->

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Modal -->
    <div class="modal" id="gallery-modal">
        <div class="modal-content">
            <span class="close-modal">×</span>
            <div class="modal-body"></div>
        </div>
    </div>

    <!-- Scripts Modularizados -->
    <script src="src/shared/loadHeader.js"></script>
    <script src="src/pages/inicio/loadInicio.js"></script>
    <script src="src/pages/about/loadAbout.js"></script>
    <script src="src/pages/features/loadFeatures.js"></script>
    <script src="src/pages/properties/loadProperties.js"></script>
    <script src="src/pages/map/loadMap.js"></script>
    <script src="src/pages/gallery/loadGallery.js"></script>
    <script src="src/pages/documentation/loadDocumentation.js"></script>
    <!--<script src="src/pages/contact/loadContact.js"></script> -->
    <script src="src/shared/loadFooter.js"></script>
    <script type="module" src="src/js/index.js"></script>
    
    <!-- CORRECCIÓN: Google Maps con carga optimizada -->
    <script>
        // Función para cargar Google Maps de forma optimizada
        function loadGoogleMaps() {
            if (window.google && window.google.maps) {
                console.log('✅ Google Maps ya disponible');
                return;
            }
            
            const script = document.createElement('script');
            script.async = true;
            script.defer = true;
            script.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyBRAPcQZ8XMPk6ZoJCalNKXxiwEPKfhDYw&libraries=geometry&callback=initMap&loading=async';
            script.onerror = function() {
                console.error('❌ Error cargando Google Maps');
                // Llamar al fallback si el script no carga
                if (typeof showFallbackMap === 'function') {
                    showFallbackMap();
                }
            };
            
            document.head.appendChild(script);
            console.log('🔄 Google Maps script cargado dinámicamente');
        }
        
        // Cargar Google Maps solo cuando el mapa esté visible o sea necesario
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Página cargada, inicializando componentes...');
            
            // Observar cuando el mapa sea visible
            const mapObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        loadGoogleMaps();
                        mapObserver.disconnect();
                    }
                });
            }, { rootMargin: '200px' });
            
            // Observar el placeholder del mapa
            const checkMapPlaceholder = () => {
                const mapPlaceholder = document.getElementById('map-placeholder');
                if (mapPlaceholder) {
                    mapObserver.observe(mapPlaceholder);
                } else {
                    // Reintentar después de 500ms si no está disponible
                    setTimeout(checkMapPlaceholder, 500);
                }
            };
            
            checkMapPlaceholder();
            
            console.log('✅ DOM cargado completamente');
            
            // Verificar EmailJS
            if (typeof emailjs !== 'undefined') {
                console.log('✅ EmailJS cargado correctamente');
            }
        });
    </script>
</body>
</html>
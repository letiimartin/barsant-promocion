<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ventanilla: Nueva promoción de 33 viviendas en Granada. Barsant Promociones Inmobiliarias ofrece viviendas de 1 a 3 dormitorios con trasteros, garajes y excelentes calidades en una ubicación privilegiada.">
    <meta name="keywords" content="comprar vivienda Granada, promoción inmobiliaria Granada, Ventanilla Granada, Barsant Promociones Inmobiliarias, viviendas nuevas Granada">
    <meta name="author" content="Barsant Promociones Inmobiliarias">
    <!-- Open Graph para redes sociales -->
    <meta property="og:title" content="Ventanilla | Barsant Promociones Inmobiliarias">
    <meta property="og:description" content="Descubre Ventanilla, 33 viviendas exclusivas en Granada desde €184,612. Diseñadas por arquitectos de prestigio, perfectas para tu nuevo hogar.">
    <meta property="og:image" content="https://www.barsantventanilla.com/images/hero.jpg">
    <meta property="og:url" content="https://www.barsantventanilla.com">
    <meta property="og:type" content="website">
    <title>Ventanilla | Barsant Promociones Inmobiliarias</title>
    <!-- Fuentes -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <!-- Iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Estilos Modularizados -->
    <link rel="stylesheet" href="/src/css/styles.css">
    <!-- Script de autenticación -->
    <script type="module" src="/src/js/auth.js"></script>
</head>
<body>

    <!-- Header -->
    <div id="header-placeholder"></div>

    <!-- Inicio Section -->
     <div id="inicio-placeholder"></div>
     
    <!-- About Section -->
    <div id="about-placeholder"></div>

    <!-- Features -->
    <div id="features-placeholder"></div>

    

    <!-- Properties -->
    <section class="properties" id="properties">
        <div class="container">
            <h2 class="section-title">Planos y Precios</h2>
            <div class="filters">
                <select id="planta-filter">
                    <option value="">Todas las Plantas</option>
                    <option value="Primero">Primera</option>
                    <option value="Segundo">Segunda</option>
                    <option value="Tercero">Tercera</option>
                    <option value="Cuarto">Cuarta</option>
                </select>
                <select id="dormitorios-filter">
                    <option value="">Todos los Dormitorios</option>
                    <option value="1">1 Dormitorio</option>
                    <option value="2">2 Dormitorios</option>
                    <option value="3">3 Dormitorios</option>
                </select>
            </div>
            <div class="table-responsive">
                <table class="properties-table">
                    <thead>
                        <tr>
                            <th>Referencia</th>
                            <th>Planta</th>
                            <th>Dormitorios</th>
                            <th>Baños</th>
                            <th>Superficie Construida</th>
                            <th>Precio</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="viviendas-table">
                        <!-- Las viviendas se cargarán dinámicamente -->
                    </tbody>
                </table>
                <p class="price-note">*A estos precios debe añadirse el IVA al tipo vigente en cada momento en que se produzca el devengo. El tipo actual es el 10%</p>
            </div>
        </div>
    </section>

    <!-- Map Section -->
    <section class="map-section" id="location">
        <div class="container">
            <h2 class="section-title">Ubicación</h2>
            <p class="description">Situado en Calle Ventanilla, en el corazón de Granada, cerca de la Alhambra y con acceso a servicios esenciales como colegios, transporte público y comercios.</p>
            <div id="map-container"></div>
        </div>
    </section>

    <!-- Scripts -->
    <script>
        // Función initMap para Google Maps
        function initMap() {
            try {
                const mapContainer = document.getElementById('map-container');
                if (!mapContainer) {
                    console.error('No se encontró el contenedor del mapa');
                    return;
                }
                
                console.log('Inicializando mapa...');
                const location = { lat: 37.182258, lng: -3.603283 }; // Coordenadas precisas de Calle Ventanilla, Granada
                const map = new google.maps.Map(mapContainer, {
                    zoom: 19,
                    center: location,
                    styles: [
                        {
                            "featureType": "poi",
                            "stylers": [{ "visibility": "simplified" }]
                        },
                        {
                            "featureType": "road",
                            "elementType": "labels.icon",
                            "stylers": [{ "visibility": "off" }]
                        }
                    ]
                });
                
                const marker = new google.maps.Marker({
                    position: location,
                    map: map,
                    title: 'Ventanilla, Granada'
                });

                // Añadir InfoWindow
                const infoWindow = new google.maps.InfoWindow({
                    content: '<h3>Ventanilla Residencial</h3><p>Calle Ventanilla, Granada<br>33 viviendas modernas en el corazón de Granada</p>'
                });

                marker.addListener('click', () => {
                    infoWindow.open(map, marker);
                });
                
                console.log('Mapa inicializado correctamente');
            } catch (error) {
                console.error('Error al cargar el mapa:', error);
                document.getElementById('map-container').innerHTML = '<p>Error al cargar el mapa. Por favor, verifica tu conexión o intenta de nuevo más tarde.</p>';
            }
        }
        
        // Asegurarse de que la función initMap esté disponible globalmente
        window.initMap = initMap;
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBRAPcQZ8XMPk6ZoJCalNKXxiwEPKfhDYw&callback=initMap"></script>

    <!-- Datos de viviendas -->
    <script>
        // Datos de viviendas, trasteros y cocheras
        window.viviendas = [
            // Bloque A (9 viviendas)
            { bloque: 'A', piso: 'Primero A', dormitorios: 2, baños: 2, supUtil: 54.35, supConst: 79.60, precio: 274620, estado: 'Disponible' },
            { bloque: 'A', piso: 'Primero B', dormitorios: 1, baños: 1, supUtil: 36.78, supConst: 50.58, precio: 187146, estado: 'Disponible' },
            { bloque: 'A', piso: 'Primero C', dormitorios: 1, baños: 1, supUtil: 36.91, supConst: 51.34, precio: 189958, estado: 'Disponible' },
            { bloque: 'A', piso: 'Segundo A', dormitorios: 2, baños: 2, supUtil: 68.65, supConst: 98.71, precio: 365227, estado: 'Disponible' },
            { bloque: 'A', piso: 'Segundo B', dormitorios: 2, baños: 2, supUtil: 76.16, supConst: 103.73, precio: 394174, estado: 'Disponible' },
            { bloque: 'A', piso: 'Tercero A', dormitorios: 2, baños: 2, supUtil: 68.65, supConst: 98.71, precio: 375098, estado: 'Disponible' },
            { bloque: 'A', piso: 'Tercero B', dormitorios: 2, baños: 2, supUtil: 76.01, supConst: 103.73, precio: 404547, estado: 'Disponible' },
            { bloque: 'A', piso: 'Cuarto A', dormitorios: 2, baños: 2, supUtil: 68.61, supConst: 98.71, precio: 394840, estado: 'Disponible' },
            { bloque: 'A', piso: 'Cuarto B', dormitorios: 2, baños: 2, supUtil: 75.97, supConst: 103.73, precio: 425293, estado: 'Disponible' },
            
            // Bloque B (10 viviendas)
            { bloque: 'B', piso: 'Primero A', dormitorios: 1, baños: 1, supUtil: 36.85, supConst: 49.71, precio: 186412.5, estado: 'Disponible' },
            { bloque: 'B', piso: 'Primero B', dormitorios: 1, baños: 1, supUtil: 36.39, supConst: 49.23, precio: 184612.5, estado: 'Disponible' },
            { bloque: 'B', piso: 'Primero C', dormitorios: 1, baños: 1, supUtil: 36.92, supConst: 50.64, precio: 189900, estado: 'Disponible' },
            { bloque: 'B', piso: 'Primero D', dormitorios: 1, baños: 1, supUtil: 37.03, supConst: 50.64, precio: 189900, estado: 'Disponible' },
            { bloque: 'B', piso: 'Segundo A', dormitorios: 3, baños: 2, supUtil: 87.58, supConst: 117.84, precio: 447792, estado: 'Disponible' },
            { bloque: 'B', piso: 'Segundo B', dormitorios: 2, baños: 2, supUtil: 76.54, supConst: 103.51, precio: 393338, estado: 'Disponible' },
            { bloque: 'B', piso: 'Tercero A', dormitorios: 3, baños: 2, supUtil: 87.59, supConst: 117.84, precio: 459576, estado: 'Disponible' },
            { bloque: 'B', piso: 'Tercero B', dormitorios: 2, baños: 2, supUtil: 76.45, supConst: 103.51, precio: 403689, estado: 'Disponible' },
            { bloque: 'B', piso: 'Cuarto A', dormitorios: 3, baños: 2, supUtil: 87.60, supConst: 117.84, precio: 483144, estado: 'Disponible' },
            { bloque: 'B', piso: 'Cuarto B', dormitorios: 2, baños: 2, supUtil: 76.34, supConst: 103.51, precio: 424391, estado: 'Disponible' },
            
            // Bloque C (4 viviendas)
            { bloque: 'C', piso: 'Primero A', dormitorios: 2, baños: 2, supUtil: 50.83, supConst: 82.72, precio: 281248, estado: 'Disponible' },
            { bloque: 'C', piso: 'Segundo A', dormitorios: 2, baños: 2, supUtil: 60.49, supConst: 98.17, precio: 343595, estado: 'Disponible' },
            { bloque: 'C', piso: 'Tercero A', dormitorios: 2, baños: 2, supUtil: 60.49, supConst: 98.17, precio: 353412, estado: 'Disponible' },
            { bloque: 'C', piso: 'Cuarto A', dormitorios: 2, baños: 2, supUtil: 58.90, supConst: 98.17, precio: 392680, estado: 'Disponible' },
            
            // Bloque D (8 viviendas)
            { bloque: 'D', piso: 'Primero A', dormitorios: 2, baños: 2, supUtil: 63.87, supConst: 98.14, precio: 318955, estado: 'Disponible' },
            { bloque: 'D', piso: 'Primero B', dormitorios: 1, baños: 1, supUtil: 38.55, supConst: 57.80, precio: 202300, estado: 'Disponible' },
            { bloque: 'D', piso: 'Segundo A', dormitorios: 1, baños: 1, supUtil: 36.96, supConst: 58.35, precio: 210060, estado: 'Disponible' },
            { bloque: 'D', piso: 'Segundo B', dormitorios: 1, baños: 1, supUtil: 34.46, supConst: 52.61, precio: 189396, estado: 'Disponible' },
            { bloque: 'D', piso: 'Segundo C', dormitorios: 1, baños: 1, supUtil: 35.99, supConst: 54.95, precio: 197820, estado: 'Disponible' },
            { bloque: 'D', piso: 'Tercero A', dormitorios: 1, baños: 1, supUtil: 36.96, supConst: 58.35, precio: 215895, estado: 'Disponible' },
            { bloque: 'D', piso: 'Tercero B', dormitorios: 1, baños: 1, supUtil: 34.46, supConst: 52.61, precio: 194657, estado: 'Disponible' },
            { bloque: 'D', piso: 'Tercero C', dormitorios: 1, baños: 1, supUtil: 35.99, supConst: 54.95, precio: 203315, estado: 'Disponible' },
            
            // Bloque E (2 viviendas)
            { bloque: 'E', piso: 'Primero A', dormitorios: 2, baños: 2, supUtil: 64.65, supConst: 105.69, precio: 338208, estado: 'Disponible' },
            { bloque: 'E', piso: 'Segundo A', dormitorios: 2, baños: 2, supUtil: 72.18, supConst: 119.16, precio: 428976, estado: 'Disponible' }
        ];
        
        // Función directa para mostrar las viviendas
        document.addEventListener('DOMContentLoaded', function() {
            const tabla = document.getElementById('viviendas-table');
            if (tabla && window.viviendas) {
                displayViviendas(window.viviendas);
            }
        });
        
        function displayViviendas(viviendas) {
            const tabla = document.getElementById('viviendas-table');
            if (!tabla) {
                console.error('No se encontró la tabla de viviendas');
                return;
            }
            
            // Limpiar tabla
            tabla.innerHTML = '';
            
            // Insertar filas
            viviendas.forEach(v => {
                const row = document.createElement('tr');
                row.className = 'vivienda-row';
                const estadoClass = v.estado === 'Reservado' ? 'estado-reservado' : 'estado-disponible';
                const viviendaId = `${v.bloque}-${v.piso.replace(' ', '-')}`.toLowerCase();
                
                row.innerHTML = `
                    <td><a href="viviendas/${viviendaId}.html" class="vivienda-link">${v.bloque}</a></td>
                    <td><a href="viviendas/${viviendaId}.html" class="vivienda-link">${v.piso}</a></td>
                    <td>${v.dormitorios}</td>
                    <td>${v.baños}</td>
                    <td>${v.supConst.toFixed(2)} m²</td>
                    <td>€${v.precio.toLocaleString()}</td>
                    <td class="${estadoClass}">${v.estado}</td>
                    <td>
                        <i class="fas fa-download plano-icon" title="Descargar plano"></i>
                        <i class="fas fa-eye plano-icon" title="Ver plano"></i>
                    </td>
                `;

                row.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('plano-icon')) {
                        window.location.href = `viviendas/${viviendaId}.html`;
                    }
                });
                
                tabla.appendChild(row);
            });
        }
        
        // Filtrar Viviendas
        function filterViviendas() {
            const plantaFilter = document.getElementById('planta-filter');
            const dormitoriosFilter = document.getElementById('dormitorios-filter');
            
            if (!plantaFilter || !dormitoriosFilter) return;
            
            const planta = plantaFilter.value;
            const dormitorios = dormitoriosFilter.value;

            let filtered = [...window.viviendas];

            if (planta) {
                filtered = filtered.filter(v => v.piso.includes(planta));
            }
            if (dormitorios) {
                filtered = filtered.filter(v => v.dormitorios == dormitorios);
            }

            displayViviendas(filtered);
        }
        
        // Asignar eventos a los filtros
        document.addEventListener('DOMContentLoaded', function() {
            const plantaFilter = document.getElementById('planta-filter');
            const dormitoriosFilter = document.getElementById('dormitorios-filter');
            
            if (plantaFilter) {
                plantaFilter.addEventListener('change', filterViviendas);
            }
            
            if (dormitoriosFilter) {
                dormitoriosFilter.addEventListener('change', filterViviendas);
            }
        });
    </script>

    <!-- Gallery -->
    <section class="gallery" id="gallery">
        <div class="container">
            <h2 class="section-title">Galería</h2>
            <div class="gallery-grid">
                <div class="gallery-item" style="background-image: url('assets/images/foto1.jpg');"></div>
                <div class="gallery-item" style="background-image: url('assets/images/foto2.jpg');"></div>
                <div class="gallery-item" style="background-image: url('assets/images/foto3.jpg');"></div>
                <div class="gallery-item" style="background-image: url('assets/images/foto4.jpg');"></div>
                <div class="gallery-item" style="background-image: url('assets/images/foto5.jpg');"></div>
            </div>
        </div>
    </section>

    <!-- Contact -->
    <section class="contact" id="contact">
        <div class="container">
            <h2 class="section-title">Contacto</h2>
            <div class="contact-wrapper">
                <div class="contact-info">
                    <div class="contact-detail">
                        <h3>Oficina de Ventas</h3>
                        <p>Calle Ventanilla, s/n, Granada, España</p>
                    </div>
                    <div class="contact-detail">
                        <h3>Horario</h3>
                        <p>Lunes a Viernes: 10:00 - 14:00 y 17:00 - 20:00</p>
                        <p>Sábados: 10:00 - 14:00</p>
                    </div>
                    <div class="contact-detail">
                        <h3>Teléfono</h3>
                        <p>+34 958 123 456</p>
                    </div>
                    <div class="contact-detail">
                        <h3>Email</h3>
                        <p>info@barsantpromociones.com</p>
                    </div>
                </div>
                <form class="contact-form" id="contact-form">
                    <div class="form-group">
                        <label for="name">Nombre Completo *</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Teléfono *</label>
                        <input type="tel" id="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="property">Vivienda de Interés</label>
                        <select id="property">
                            <option value="">Seleccione una opción</option>
                            <option value="1-dormitorio">1 Dormitorio</option>
                            <option value="2-dormitorios">2 Dormitorios</option>
                            <option value="3-dormitorios">3 Dormitorios</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="message">Mensaje</label>
                        <textarea id="message"></textarea>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="cta-button">Enviar Solicitud</button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h4>Barsant Promociones</h4>
                    <p>Empresa de reciente creación con amplia experiencia en el sector inmobiliario y empresarial, comprometida con la calidad y la excelencia en cada uno de sus proyectos.</p>
                </div>
                <div class="footer-column">
                    <h4>Enlaces Rápidos</h4>
                    <ul>
                        <li><a href="#home">Inicio</a></li>
                        <li><a href="#about">La Promoción</a></li>
                        <li><a href="#properties">Viviendas</a></li>
                        <li><a href="#location">Ubicación</a></li>
                        <li><a href="#gallery">Galería</a></li>
                        <li><a href="#contact">Contacto</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>Promociones</h4>
                    <ul>
                        <li><a href="#properties">Ventanilla</a></li>
                        <li><a href="#">Próximos Proyectos</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="legal/aviso-legal.html">Aviso Legal</a></li>
                        <li><a href="legal/politica-privacidad.html">Política de Privacidad</a></li>
                        <li><a href="legal/politica-cookies.html">Política de Cookies</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p> 2025 Barsant Promociones Inmobiliarias. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Modal -->
    <div class="modal" id="gallery-modal">
        <div class="modal-content">
            <span class="close-modal">×</span>
            <div class="modal-body"></div>
        </div>
    </div>

    <!-- Scripts Modularizados -->
    <script type="module" src="src/js/index.js"></script>

    <script src="src/shared/loadHeader.js"></script>
    <script src="src/pages/inicio/loadInicio.js"></script>
    <script src="src/pages/about/loadAbout.js"></script>
    <script src="src/pages/features/loadFeatures.js"></script>
</body>
</html>